-- By JoJo#2494
-- Script Name: Timestop
-- https://discord.gg/jojow

assert(getrawmetatable)
gmt = getrawmetatable(game)
setreadonly(gmt, false)
old = gmt.__namecall
gmt.__namecall =
	newcclosure(
		function(self, ...)
		local args = {...}
		if tostring(args[1]) == "BreathingHAMON" then
			return
		elseif tostring(args[1]) == "TeleportDetect" then
			return
		elseif tostring(args[1]) == "CHECKER_1" then
			return
		elseif tostring(args[1]) == "CHECKER" then
			return
		elseif tostring(args[1]) == "GUI_CHECK" then
			return
		elseif tostring(args[1]) == "OneMoreTime" then
			return
		elseif tostring(args[1]) == "checkingSPEED" then
			return
		elseif tostring(args[1]) == "BANREMOTE" then
			return
		elseif tostring(args[1]) == "PERMAIDBAN" then
			return
		elseif tostring(args[1]) == "KICKREMOTE" then
			return
		elseif tostring(args[1]) == "BR_KICKPC" then
			return end
    return old(self, ...)
end)

lp = game:GetService("Players").LocalPlayer
TweenService = game:GetService("TweenService")
rs = game:GetService("RunService")

local OriginalKeyUpValue = 0

function StopAudio()
	game:GetService("Players").LocalPlayer.Character.LowerTorso.BOOMBOXSOUND:Stop()
end

function Stop(ID, Key)
	local cor = coroutine.wrap(function()
	wait(game:GetService("Players").LocalPlayer.Character.LowerTorso.BOOMBOXSOUND.TimeLength-0.1)
		if game:GetService("Players").LocalPlayer.Character.LowerTorso.BOOMBOXSOUND.SoundId == "rbxassetid://"..ID and OriginalKeyUpValue == Key then
			StopAudio()
		end
    end)
cor()
end

function Play(ID, STOP)
	if game:GetService("Players").LocalPlayer.Backpack:FindFirstChild("[Boombox]") then
		local Tool = nil
		game:GetService("Players").LocalPlayer.Backpack["[Boombox]"].Parent = game:GetService("Players").LocalPlayer.Character
		game:GetService("ReplicatedStorage").MainEvent:FireServer("Boombox", ID)
		game:GetService("Players").LocalPlayer.Character["[Boombox]"].RequiresHandle = false
          if game:GetService("Players").LocalPlayer.Character["[Boombox]"]:FindFirstChild("Handle") then
            game:GetService("Players").LocalPlayer.Character["[Boombox]"].Handle:Destroy()
          end
          game:GetService("Players").LocalPlayer.Character["[Boombox]"].Parent = game:GetService("Players").LocalPlayer.Backpack
          game:GetService("Players").LocalPlayer.PlayerGui.MainScreenGui.BoomboxFrame.Visible = false
          if Tool ~= true then
              if Tool then
                  Tool.Parent = game:GetService("Players").LocalPlayer.Character
              end
          end
          if STOP == true then
            game:GetService("Players").LocalPlayer.Character.LowerTorso:WaitForChild("BOOMBOXSOUND")
                local cor = coroutine.wrap(function()
                  repeat wait() until game:GetService("Players").LocalPlayer.Character.LowerTorso.BOOMBOXSOUND.SoundId == "rbxassetid://"..ID and game:GetService("Players").LocalPlayer.Character.LowerTorso.BOOMBOXSOUND.TimeLength > 0.0001
                  OriginalKeyUpValue = OriginalKeyUpValue+1
                  Stop(ID, OriginalKeyUpValue)
				end)
			cor()
		end
	end
end

function Chat(Novapurge)
    local A_1 = Novapurge
    local A_2 = "All"
    local Event = game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest
    Event:FireServer(A_1, A_2)
end

game:GetService("UserInputService").InputBegan:Connect(function(Key)
    if Key.KeyCode == Enum.KeyCode[string.upper(TimeStopSettings.KEYBIND)] then
          if _G.TimeStopped or game:GetService("UserInputService"):GetFocusedTextBox() then return end
            pcall(function()
                _G.TimeStopped = true
                    if TimeStopSettings.MODE == "JOTARO" then 
                        Chat("Star Platinum: The World") 
                        Play(5174615212,true)
                    else  
                        Chat("ZA WARUDOO!")
						Play(7514417921,true)
                    end
                	if TimeStopSettings.MODE == "JOTARO" then
					wait(2.3) 
					Play(3690430410,true)
					coroutine.wrap(function()
						TweenService:Create(workspace.CurrentCamera, TweenInfo.new(0.5), {FieldOfView = 90}):Play()
						TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Saturation = -1}):Play()
						local blur = Instance.new("BlurEffect", game:GetService("Lighting"))
						TweenService:Create(blur, TweenInfo.new(0.8), {Size = 10}):Play()
						TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Saturation = -1}):Play()
						TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Contrast = -2}):Play()
						wait(0.25)
						settings().Network.IncomingReplicationLag = math.huge
						wait(0.5)
						TweenService:Create(workspace.CurrentCamera, TweenInfo.new(0.5), {FieldOfView = 80}):Play()
						game:GetService("Lighting").ColorCorrection.TintColor = Color3.fromRGB(250,250,250)
						TweenService:Create(blur, TweenInfo.new(0.8), {Size = 0}):Play()
						wait(0.5)
						game:GetService("Workspace").Camera.FieldOfView = 80
					end)()
					wait(1.92)
					StopAudio()
				else
				wait(2)
					coroutine.wrap(function()
						TweenService:Create(workspace.CurrentCamera, TweenInfo.new(0.5), {FieldOfView = 90}):Play()
						TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Saturation = -1}):Play()
						local blur = Instance.new("BlurEffect", game:GetService("Lighting"))
						TweenService:Create(blur, TweenInfo.new(0.8), {Size = 10}):Play()
						TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Saturation = -1}):Play()
						TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Contrast = -2}):Play()
						wait(0.25)
						settings().Network.IncomingReplicationLag = math.huge
						wait(0.5)
						TweenService:Create(workspace.CurrentCamera, TweenInfo.new(0.5), {FieldOfView = 80}):Play()
						game:GetService("Lighting").ColorCorrection.TintColor = Color3.fromRGB(250,250,250)
						TweenService:Create(blur, TweenInfo.new(0.8), {Size = 0}):Play()
						wait(0.5)
						game:GetService("Workspace").Camera.FieldOfView = 80
					end)()
                end
            wait(tonumber(TimeStopSettings.TIME))
            _G.TimeStopped = false
			if TimeStopSettings.MODE == "JOTARO" then 
			settings().Network.IncomingReplicationLag = 0
			Play(3101648169,true)
			else
			settings().Network.IncomingReplicationLag = 0
			Play(4569573112,true)
			end
            TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Saturation = 0}):Play()
			TweenService:Create(game:GetService("Lighting").ColorCorrection, TweenInfo.new(0.8), {Contrast = 0}):Play()
			TweenService:Create(workspace.CurrentCamera, TweenInfo.new(0.5), {FieldOfView = 70}):Play()
			wait(0.5)
			game:GetService("Workspace").Camera.FieldOfView = 70
		end)
	end
end)
